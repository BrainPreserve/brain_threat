<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-store" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brain Threat Analysis — Standalone App</title>

  <!-- Keep original stylesheet as requested -->
  <link rel="stylesheet" href="assets/ui.css" />

  <!-- Minimal inline styles for structural elements (non-conflicting) -->
  <style>
    /* Non-invasive helpers; keep to IDs only to avoid overriding ui.css */
    #app { max-width: 1100px; margin: 0 auto; padding: 12px; }
    #error-banner { display: none; margin: 12px 0; padding: 12px; border: 2px solid #b30000; background: #ffe6e6; color: #b30000; font-weight: 600; }
    #global-actions { margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap; }
    #summary-block { margin-top: 16px; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
  </style>
</head>
<body>
  <noscript>
    <div style="padding:12px;border:2px solid #b30000;background:#ffe6e6;color:#b30000;">
      This application requires JavaScript to run.
    </div>
  </noscript>

  <div id="app" role="application" aria-label="Brain Threat Analysis App">
    <!-- RED BANNER: shown by app.js when strict-contract validation fails -->
    <div id="error-banner" role="alert" aria-live="assertive"></div>

    <!-- App Header -->
    <header>
      <h1>Brain Threat Analysis</h1>
      <p class="subtitle">Clean rebuild from WordPress code + master.csv (strict contract; no heuristics)</p>
    </header>

    <!-- Summary (rendered by summary.js after user interaction) -->
    <section id="summary-block" aria-label="Summary">
      <h2>Summary</h2>
      <div id="summary-content">
        <!-- summary.js will populate structured, category-level and global summaries -->
      </div>

      <!-- Global actions placed BELOW the summary per requirement -->
      <div id="global-actions">
        <button id="copy-summary-btn" type="button" aria-label="Copy summary to clipboard">
          Copy Summary
        </button>
        <button id="clear-form-btn" type="button" aria-label="Clear all answers and recollapse all sections">
          Clear Form
        </button>
      </div>
    </section>

    <!-- Categories container; app.js will render ALL seven top-level, collapsed on load -->
    <section id="categories" aria-label="Top-level categories">
      <!--
        app.js renders these EXACT seven top-level sections as collapsed accordions (▸ closed; ▾ open):
          1) Personal History
             - contains collapsible questionnaires: Personal History (core), Medical & Lifestyle, Sleep, Stress, Physical Activity
          2) Social & Loneliness Assessment (LSNS-6, UCLA-3)
          3) Sensory Assessment
             - sub-accordions: Hearing (HHIE-S), Vision (VFQ-3of7), both collapsed on load
          4) Medication Threat Assessment (meds show generic + brand_name from CSV)
          5) Micro/Nanoplastic Exposure Assessment (helper text from CSV threat column)
          6) Toxin Exposure Assessment (helper text from CSV threat column)
          7) Brain Threat Foods and Additives Assessment (helper text from CSV threat column)

        Each top-level section includes a “Clear This Section” button that resets ONLY that section
        and re-collapses it. All fetch() calls use { cache: "no-store" } inside scripts.
      -->
    </section>

    <!-- Footer note (optional, non-functional) -->
    <footer style="margin-top:24px;">
      <p class="sr-only">All data loads are performed with no-store caching and strict CSV contract: item_key → threat/brand_name only.</p>
    </footer>
  </div>

  <!-- Scripts: load order matters. config → scoring → summary → app -->
  <script defer src="assets/config.js"></script>
  <script defer src="assets/scoring.js"></script>
  <script defer src="assets/summary.js"></script>
  <script defer src="assets/app.js"></script>
</body>
</html>
